<div th:replace="shared/header"></div>
<div class="row">
    <div class="col-xs-12">
        <!-- jQuery Knob -->
        <div class="box box-solid">
            <div class="box-header">
                <i class="fa fa-bar-chart-o"></i>

                <h3 class="box-title">jQuery Knob</h3>

                <div class="box-tools pull-right">
                    <button type="button" class="btn btn-default btn-sm" data-widget="collapse"><i class="fa fa-minus"></i>
                    </button>
                    <button type="button" class="btn btn-default btn-sm" data-widget="remove"><i class="fa fa-times"></i>
                    </button>
                </div>
            </div>
            <!-- /.box-header -->
            <div class="box-body">
                <div class="row">

                    <div class="col-xs-6 col-md-3 text-center" th:each="project:${records}">
                        <input type="text" class="knob" value="30" data-width="90" data-height="90" th:data-fgColor="${project.status.statusColor}">

                        <div class="knob-label" th:text="${project.projectName}"></div>
                    </div>

                </div>

            </div>
            <!-- /.box-body -->
        </div>
        <!-- /.box -->
    </div>
    <!-- /.col -->
</div>

<div class="col-md-12">
    <div class="box">
        <div class="box-header with-border">
            <h3 class="box-title">
                <a th:href="@{${pageURI}+'/create'}" class="btn btn-primary btn-xs abc">
                    <span class="glyphicon glyphicon-plus"></span>
                </a>
            </h3>
        </div>
        <!-- /.box-header -->
        <div class="box-body">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Id</th>
                        <th>Project Name</th>
                        <th>Budget</th>
                        <th style="text-align: center">Members</th>
                        <th>Deadline</th>
                        <th>Task</th>
                        <th>Client</th>
                        <th>Status</th>
                        <th>Conversation</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="myTbody">
                    <tr th:each="project:${records}">
                        <td th:text="${project.id}"></td>
                        <td th:text="${project.projectName}"></td>
                        <td th:text="${project.budget}"></td>     
                        <td style="text-align: center">                            
                            <a  href="javascript:void(0)" class="list-emp-btn btn btn-default btn-xs"
                                th:text="${project.employeeList.size()}"></a>
                            <a  href="javascript:void(0)" th:rel="${project.id}" class="add-emp-btn btn btn-default btn-xs">
                                <span class="glyphicon glyphicon-plus"></span>
                            </a>                           
                        </td>
                        <td th:text="${#dates.format(project.deadline, 'yyyy-MM-dd')}"></td>
                        <td>
                             <a  href="javascript:void(0)" class="btn btn-default btn-xs"
                                th:text="${project.tasks.size()}"></a>
                            <a  href="javascript:void(0)" th:rel="${project.id}" class="btn btn-default btn-xs">
                                <span class="glyphicon glyphicon-plus"></span>
                            </a>  
                        </td>
                        <td>
                            <a class="client-popover-btn" data-popover-content=".client-popover" role="button" >
                                <span  th:text="${project.client.firstName}+' '+${project.client.lastName}"></span>
                            </a>
                        </td>
                        <td th:style="'background:'+${project.status.statusColor}">
                        </td>
                        <td>
                            <a  href="javascript:void(0)" class="btn btn-default btn-xs"
                                th:text="${project.conversations.size()}"></a>
                            <a th:href="@{'/'+${pageURI}+'/conversation/'+${project.id}}" class="btn btn-primary btn-xs">Conversation

                                <span class="glyphicon glyphicon-eye-open"></span> 
                            </a>

                        </td>
                        <td>
                            <a th:href="@{'/'+${pageURI}+'/detail/'+${project.id}}" class="btn btn-primary btn-xs">
                                <span class="glyphicon glyphicon-eye-open"></span> 
                            </a>
                            <a th:href="@{'/'+${pageURI}+'/edit/'+${project.id}}" class="btn btn-success btn-xs">
                                <span class="glyphicon glyphicon-pencil"></span>
                            </a>
                            <a th:href="@{'/'+${pageURI}+'/delete/'+${project.id}}" onclick="return confirm('Are you sure to delete?')" class="btn btn-danger btn-xs">
                                <span class="glyphicon glyphicon-trash"></span>
                            </a>
                        </td>                        
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- /.box-body -->
        <div class="box-footer clearfix">
            <ul class="pagination pagination-sm no-margin pull-right">
                <li><a href="#">&laquo;</a></li>
                <li><a href="#">1</a></li>
                <li><a href="#">2</a></li>
                <li><a href="#">3</a></li>
                <li><a href="#">&raquo;</a></li>
            </ul>
        </div>
    </div>
</div>

<!--client popover content-->
<div class="client-popover" style="display: none">
    <div class="popover-body">       
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Id</th>
                    <th>Name</th>
                    <th>Address</th>
                    
                </tr>
            </thead>
            <tbody>
                <tr th:each="project:${projectclient}">
                    
                </tr>
            </tbody>
        </table>
    </div>
</div>

<div th:replace="addemployee"></div>
<div th:replace="emplist"></div>
<div th:replace="shared/footer"></div>
<script src="/webjars/adminlte/2.3.11/plugins/knob/jquery.knob.js"></script>
<script>
    $(document).ready(function(){
    $('.add-emp-btn').on('click',function(){
    var $id=$(this).attr('rel');
    $('#modal-project-id').val($id);
    $('#modal-addemp').modal();
    });

    $('#add-employee-form').on('submit',function(){
    $.post('/projects/employees/add',$(this).serialize(),function(data){
    console.log(data);
    $('#modal-addemp').modal('hide');
    });
    return false;
    });
    $('.list-emp-btn').on('click',function(){
    $('#modal-listEmp').modal();        
    });
    });


    $(function(){
    $('.client-popover-btn').popover({
    html:true,
    placement:'top',
    trigger: 'hover',
    content: function(){    
    var content = $(this).attr("data-popover-content");
    return $(content).children(".popover-body").html();
    }
    });
    });

    <!--------------------->
    $(document).ready(function(){
    $.getJSON('/projects/employees',function(data){
    $.each(data,function(index,row){
    console.log(row);    
    });
    });
    });

    $(".knob").knob();

</script>
